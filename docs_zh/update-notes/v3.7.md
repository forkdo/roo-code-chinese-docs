---
description: Roo Code 3.7 引入了 Claude Sonnet 3.7 支持、扩展的思维模型（128k token）、Mermaid 图表、键盘快捷键以及众多改进。
keywords:
  - roo code 3.7
  - claude sonnet 3.7
  - thinking models
  - mermaid diagrams
  - keyboard shortcuts
  - vertex ai
  - openrouter
  - release notes
---

# Roo Code 3.7 版本说明 (2025-03-03)

此版本周期推出了 Roo Code 3.7，包括对 Claude Sonnet 3.7 的支持、扩展的模型能力（包括“思维”Sonnet 和增加的 token 限制）、Vertex AI 增强功能、改进的上下文窗口管理、UI 优化（如 Mermaid 图表和拖放功能）以及众多错误修复。

---

## 提供商更新与模型增强

*   **Claude Sonnet 3.7 支持：** 在 Anthropic、Vertex AI（包括“思维”模式）和 AWS Bedrock 提供商中引入了对 Claude Sonnet 3.7 的支持。将一些默认设置更新为 Sonnet 3.7。（感谢 lupuletic、cte、aitoroses！）
*   **扩展的模型能力：**
    *   将思维模型的最大 token 数增加到 128k，最大思维预算增加到超过 100k。（感谢 monotykamary！）
    *   添加了滑块来控制思维模型的最大输出 token 数。
    *   为 OpenRouter 上的 Claude 3.7 Sonnet 启用了“思维预算”滑块。
*   **Vertex AI：**
    *   在 Vertex AI 上添加了 Gemini 模型。（感谢 ashktn！）
    *   为 Vertex AI 上的 Claude 模型添加了提示缓存支持。（感谢 aitoroses、lupuletic！）
*   **OpenRouter：**
    *   默认启用中间向外压缩。
    *   在欢迎屏幕上正确填充了默认的 OpenRouter 模型。
    *   改进了错误处理（不再出现“提供商错误”）。
*   **Anthropic：** 使用 `count_tokens` API 进行更准确的上下文窗口管理。
*   **OpenAI：** 添加了 `gpt-4.5-preview`。

---

## 生活质量改进与 UI 增强

*   **键盘快捷键：** 添加了用于切换模式的键盘快捷键，包括自定义模式。（感谢 aheizi！）
*   **Mermaid 图表支持：** 添加了在聊天中渲染 Mermaid 图表的支持。（感谢 Cline！）
*   **拖放功能：** 支持将多个文件拖放到聊天中。
*   **上下文窗口管理：** 实现了更智能的上下文窗口管理并修复了截断计算。
*   **UI 优化：**
    *   增强了删除任务确认功能。
    *   美化了思维块。
    *   修复了下拉菜单悬停颜色。（感谢 SamirSaji！）
    *   为按钮添加了提示信息以提高清晰度。
    *   改进了 ChatRow 中长文本的处理。（感谢 joemanley201！）
*   **系统提示自定义：** 添加了自定义系统提示的高级功能。
*   **检查点：** 将检查点从测试版毕业，并添加了加载缓慢的警告。
*   **浏览器工具：** 添加了用于禁用浏览器工具的复选框。

---

## 错误修复

*   修复了键盘模式切换器未更新 API 配置文件的问题。（感谢 aheizi！）
*   修复了 Claude 3.7 Sonnet 模型的最大 token 数默认值。
*   修复了切换配置文件时“思维”设置未更新的问题。
*   修复了 OpenRouter 的 `anthropic/claude-3.7-sonnet:beta` 的计算机使用和提示缓存问题。（感谢 cte！）
*   修复了 Sonnet 3.7 的滑动窗口计算。（感谢 cte！）
*   修复了使用思维 Sonnet 时的增强提示按钮。
*   修复了模型选择器的各种问题。（感谢 System233！）
*   修复了模型输入/输出成本解析。（感谢 System233！）
*   改进了终端输出解析。（感谢 KJ7LNW！）
*   修复了非思维模型的自定义最大 token 数未被遵守的问题。

---

## 其他改进

*   在系统提示中更强烈地鼓励使用差异编辑。（感谢 hannesrudolph！）
*   如果模式不支持 MCP，则从提示中排除 MCP 指令。
*   更新了 VS LM API 的警告文本。
*   支持可运行命令的只读模式。
*   截断 `search_files` 输出以防止崩溃。